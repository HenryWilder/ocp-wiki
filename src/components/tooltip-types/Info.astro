---
import Tooltip from "./Tooltip.astro";
import type { ITooltipBase } from "../../scripts/index";

import containmentSites from "../../../public/data/containment-sites.json";
import objects from "../../../public/data/objects.json";
import staff from "../../../public/data/staff.json";
import taskForces from "../../../public/data/task-forces.json";

interface ISharedTooltipInfo {
    category: string;
    path: string;
    linkText: string;
}
let sharedInfo: ISharedTooltipInfo = { category:"", path:"", linkText:"" };

interface Props {
    code: string;
}
const { code } = Astro.props;

// The above switch statement as a series of if statements:

// Think of a good name for this
const sharedInfoOptions =
    [{ src:containmentSites as ITooltipBase[], prefix:"site",  category:"Containment Site",  path:`/info/containment-sites.html#${code}`, linkText:"" },
     { src:objects as ITooltipBase[],          prefix:"ocp",   category:"Anomalous Object",  path:`/objects/${code.substring(4)}.html`,   linkText:"read document" },
     { src:staff as ITooltipBase[],            prefix:"staff", category:"Staff Member",      path:`/info/staff.html#${code}`,             linkText:"" },
     { src:taskForces as ITooltipBase[],       prefix:"mtf",   category:"Mobile Task Force", path:`/info/task-forces.html#${code}`,       linkText:"" }];

sharedInfoOptions.forEach(option => {
    if (code.substring(0, option.prefix.length) == option.prefix) {
        info = option.src[code];
        sharedInfo = { category:option.category, path:option.path, linkText:option.linkText };
    }
});
if (sharedInfo.category == "") throw new Error(`Type "${code}" is not specialized`);

---
<Tooltip category={sharedInfo.category} name={info.name} tagline={info.tagline} path={sharedInfo.path} linkText={sharedInfo.linkText} notes={info.notes}><slot /></Tooltip>
